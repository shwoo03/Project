{
    "id": "file-download-1",
    "name": "File Download #1 - Path Traversal",
    "level": "새싹",
    "source": "dreamhack",
    "description": "파일 다운로드 기능에서 경로 검증 누락으로 인한 Path Traversal 취약점. /upload에서는 ..을 필터링하지만 /read에서는 필터링하지 않아 ../를 통해 업로드 디렉터리 외부 파일 접근 가능",
    "vulnerabilities": [
        {
            "type": "path-traversal-taint-flask",
            "line": 32,
            "severity": "ERROR",
            "description": "/upload 엔드포인트: ..을 필터링하지만 불완전한 검증 (우회 가능)",
            "is_false_positive": false,
            "note": "필터링이 있으나 Semgrep이 정적 분석으로 탐지. 실제로는 방어됨"
        },
        {
            "type": "path-traversal-taint-flask",
            "line": 50,
            "severity": "ERROR",
            "description": "/read 엔드포인트: 사용자 입력(request.args.get('name'))이 검증 없이 open() 함수에 직접 사용되어 경로 탐색 취약점 발생 (실제 취약점)",
            "is_false_positive": false
        }
    ],
    "expected_findings": 2,
    "exploit": {
        "url": "/read?name=../flag.py",
        "method": "GET",
        "description": "../ 를 사용해 상위 디렉터리의 flag.py 파일 읽기"
    },
    "mitigation": {
        "description": "os.path.abspath()와 startswith()를 사용해 경로가 허용된 디렉터리 내에 있는지 검증",
        "code": "import os\nbase_dir = os.path.abspath(UPLOAD_DIR)\ntarget_path = os.path.abspath(os.path.join(base_dir, filename))\nif not target_path.startswith(base_dir):\n    return 'Invalid Access', 403"
    }
}
